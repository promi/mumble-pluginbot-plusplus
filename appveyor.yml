platform: x64

environment:
  matrix:
#    - compiler: msvc
#      ARCH: amd64
#      CFG: release
#    - compiler: msvc
#      ARCH: x86
#      CFG: release
#    - compiler: msvc
#      ARCH: amd64
#      CFG: debug
#    - compiler: msvc
#      ARCH: x86
#      CFG: debug
    - compiler: msys2
      MINGW_PREFIX: /c/msys2/mingw64/
      MINGW_CHOST: x86_64-w64-mingw32
      MSYS2_ARCH: x86_64
#    - compiler: msys2
#      MINGW_PREFIX: /c/msys2/mingw32/
#      MINGW_CHOST: i686-w64-mingw32
#      MSYS2_ARCH: i686

build_script:
  - 'if "%compiler%"=="msys2" set PATH=C:\msys64\mingw64\bin;C:\msys64\usr\bin;C:\msys64;%PATH%'
  - 'if "%compiler%"=="msys2" mingw64_shell.bat "pacman --noconfirm -S mingw-w64-$MSYS2_ARCH-{opus,protobuf}"'
  - 'if "%compiler%"=="msys2" mingw64_shell.bat "echo $PKG_CONFIG_PATH"'
  - 'if "%compiler%"=="msys2" mingw64_shell.bat "ls -l /mingw64/lib/pkgconfig/"'
  - 'if "%compiler%"=="msys2" mingw64_shell.bat "cd $APPVEYOR_BUILD_FOLDER; ./autogen.sh; ./configure --build=$MINGW_CHOST --host=$MINGW_CHOST --prefix=$MINGW_PREFIX; make; make check"'

# disable automatic tests
test: off
